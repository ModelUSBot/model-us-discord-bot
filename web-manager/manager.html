<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ Bot Manager Pro - UPDATED</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .container {
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 20px;
            padding: 40px; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1); max-width: 1200px; width: 100%;
        }
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { font-size: 2.5rem; color: #333; margin-bottom: 10px; }
        .header p { color: #666; font-size: 1.1rem; }
        .status-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px; padding: 30px; margin-bottom: 30px; border-left: 5px solid #4CAF50;
        }
        .status-indicator {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            font-size: 1.5rem; font-weight: bold; margin-bottom: 20px;
        }
        .status-dot { width: 20px; height: 20px; border-radius: 50%; animation: pulse 2s infinite; }
        .status-online { background-color: #4CAF50; box-shadow: 0 0 10px rgba(76, 175, 80, 0.5); }
        .status-offline { background-color: #f44336; box-shadow: 0 0 10px rgba(244, 67, 54, 0.5); }
        .status-unknown { background-color: #ff9800; box-shadow: 0 0 10px rgba(255, 152, 0, 0.5); }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .status-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;
        }
        .status-card {
            background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); text-align: center;
        }
        .status-card h3 { color: #333; margin-bottom: 10px; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }
        .status-card .value { font-size: 1.5rem; font-weight: bold; color: #4CAF50; }
        .controls-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;
        }
        .btn {
            padding: 15px 25px; border: none; border-radius: 12px; font-size: 1rem; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center;
            gap: 10px; text-transform: uppercase; letter-spacing: 0.5px;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .btn-start { background: linear-gradient(135deg, #4CAF50, #45a049); color: white; }
        .btn-stop { background: linear-gradient(135deg, #f44336, #da190b); color: white; }
        .btn-restart { background: linear-gradient(135deg, #2196F3, #0b7dda); color: white; }
        .btn-register { background: linear-gradient(135deg, #ff9800, #e68900); color: white; }
        .btn-logs { background: linear-gradient(135deg, #607d8b, #455a64); color: white; }
        .notification {
            position: fixed; top: 20px; right: 20px; padding: 15px 20px; border-radius: 10px;
            color: white; font-weight: 600; z-index: 1000; transform: translateX(400px);
            transition: transform 0.3s ease; max-width: 400px;
        }
        .notification.show { transform: translateX(0); }
        .notification.success { background: linear-gradient(135deg, #4CAF50, #45a049); }
        .notification.error { background: linear-gradient(135deg, #f44336, #da190b); }
        .logs-section {
            background: #1e1e1e; border-radius: 15px; padding: 20px; margin-top: 30px; display: none;
        }
        .logs-header { color: #fff; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        .logs-content {
            background: #000; color: #00ff00; padding: 20px; border-radius: 10px;
            font-family: 'Courier New', monospace; font-size: 0.9rem; max-height: 400px;
            overflow-y: auto; white-space: pre-wrap; line-height: 1.4;
        }
        .footer { text-align: center; margin-top: 30px; color: #666; font-size: 0.9rem; }
        .loading::after {
            content: ''; position: absolute; top: 50%; left: 50%; width: 20px; height: 20px;
            margin: -10px 0 0 -10px; border: 2px solid transparent; border-top: 2px solid white;
            border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Bot Manager Pro - UPDATED!</h1>
            <p>Advanced control panel (NO dangerous update button)</p>
        </div>

        <div class="status-section">
            <div class="status-indicator">
                <div class="status-dot" id="statusDot"></div>
                <span id="statusText">Checking status...</span>
            </div>
            <div class="status-grid" id="statusGrid"></div>
        </div>

        <div class="controls-grid">
            <button class="btn btn-start" onclick="executeAction('start')">‚ñ∂Ô∏è Start Bot</button>
            <button class="btn btn-stop" onclick="executeAction('stop')">‚èπÔ∏è Stop Bot</button>
            <button class="btn btn-restart" onclick="executeAction('restart')">üîÑ Restart Bot</button>
            <button class="btn btn-register" onclick="executeAction('register')">üìù Register Commands</button>
            <button class="btn btn-logs" onclick="executeAction('logs')">üìã View Logs</button>
        </div>

        <div class="logs-section" id="logsSection">
            <div class="logs-header">
                <h3>üìã Bot Logs</h3>
                <button class="btn" style="padding: 5px 10px; font-size: 0.8rem;" onclick="hideLogs()">Close</button>
            </div>
            <div class="logs-content" id="logsContent"></div>
        </div>

        <div class="footer">
            <p>Bot Manager Pro - UPDATED | Last updated: <span id="lastUpdate">Loading...</span></p>
            <p>Server: Oracle Cloud | No dangerous buttons!</p>
        </div>
    </div>

    <script>
        let statusInterval;
        document.addEventListener('DOMContentLoaded', function() { updateStatus(); startStatusUpdates(); });
        function startStatusUpdates() { statusInterval = setInterval(updateStatus, 5000); }
        function stopStatusUpdates() { if (statusInterval) clearInterval(statusInterval); }

        async function updateStatus() {
            try {
                const response = await fetch('/api/status');
                const status = await response.json();
                updateStatusDisplay(status);
                updateLastUpdateTime();
            } catch (error) {
                console.error('Failed to update status:', error);
                showNotification('Failed to update status', 'error');
            }
        }

        function updateStatusDisplay(status) {
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            const statusGrid = document.getElementById('statusGrid');
            
            statusDot.className = 'status-dot';
            if (status.status === 'online') {
                statusDot.classList.add('status-online');
                statusText.textContent = 'üü¢ Bot is Online';
                statusText.style.color = '#4CAF50';
            } else if (status.status === 'offline') {
                statusDot.classList.add('status-offline');
                statusText.textContent = 'üî¥ Bot is Offline';
                statusText.style.color = '#f44336';
            } else {
                statusDot.classList.add('status-unknown');
                statusText.textContent = 'üü° Status Unknown';
                statusText.style.color = '#ff9800';
            }
            
            statusGrid.innerHTML = '';
            if (status.status === 'online') {
                const cards = [
                    { title: 'Uptime', value: status.uptime || 'N/A' },
                    { title: 'Memory Usage', value: status.memory || 'N/A' },
                    { title: 'CPU Usage', value: status.cpu || 'N/A' },
                    { title: 'Restarts', value: status.restarts || '0' }
                ];
                cards.forEach(card => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'status-card';
                    cardElement.innerHTML = `<h3>${card.title}</h3><div class="value">${card.value}</div>`;
                    statusGrid.appendChild(cardElement);
                });
            } else {
                const messageCard = document.createElement('div');
                messageCard.className = 'status-card';
                messageCard.style.gridColumn = '1 / -1';
                messageCard.innerHTML = `<h3>Status</h3><div class="value" style="color: #f44336;">${status.message || 'Bot is not running'}</div>`;
                statusGrid.appendChild(messageCard);
            }
        }

        async function executeAction(action) {
            const button = event.target;
            const originalText = button.innerHTML;
            button.disabled = true;
            button.classList.add('loading');
            button.innerHTML = 'Processing...';
            
            try {
                const response = await fetch('/api/action', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action })
                });
                const result = await response.json();
                
                if (result.success) {
                    showNotification(result.message, 'success');
                    if (action === 'logs') showLogs(result.output);
                    setTimeout(updateStatus, 1000);
                } else {
                    showNotification(result.message, 'error');
                }
            } catch (error) {
                console.error('Action failed:', error);
                showNotification('Action failed: ' + error.message, 'error');
            } finally {
                button.disabled = false;
                button.classList.remove('loading');
                button.innerHTML = originalText;
            }
        }

        function showNotification(message, type = 'info') {
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        function showLogs(logs) {
            const logsSection = document.getElementById('logsSection');
            const logsContent = document.getElementById('logsContent');
            logsContent.textContent = logs || 'No logs available';
            logsSection.style.display = 'block';
            logsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function hideLogs() {
            document.getElementById('logsSection').style.display = 'none';
        }

        function updateLastUpdateTime() {
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
        }

        document.addEventListener('visibilitychange', function() {
            if (document.hidden) stopStatusUpdates();
            else { updateStatus(); startStatusUpdates(); }
        });
    </script>
</body>
</html>